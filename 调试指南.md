# 调试指南 - 程序没反应怎么办

## 📋 诊断步骤

### 步骤 1：测试 GUI 是否正常

运行测试脚本：
```bash
双击：测试GUI.bat
```

**如果能看到测试窗口** → PyQt5 正常 ✅
**如果看不到** → 跳转到步骤 2

---

### 步骤 2：检查控制台输出

运行截图工具时，应该看到：
```
=================================
  Windows 截图工具
=================================
正在启动...

请按住鼠标左键拖动选择截图区域
按 ESC 键取消
```

**如果看不到这些输出** → Python 有问题

**如果看到了，但窗口没显示** → 继续步骤 3

---

### 步骤 3：检查窗口是否被隐藏

可能的情况：
1. 窗口显示在另一个屏幕上
2. 窗口被其他程序遮挡
3. 窗口真的没有显示

**解决方法：**

#### 方法 A：查看任务栏
- 检查任务栏是否有新窗口
- 尝试 Alt+Tab 切换窗口

#### 方法 B：按 ESC 取消
- 如果程序启动了，按 ESC 应该能退出
- 并显示"已取消截图"

#### 方法 C：等待几秒
- 程序启动可能需要 1-2 秒
- 不要立即操作

---

## 🔧 常见问题和解决方案

### 问题 1：窗口一闪而过

**原因**：窗口没有正确保持显示

**解决**：已在新版本中修复，重新运行即可

---

### 问题 2：看不到黑色半透明窗口

**原因**：
- 多显示器环境，窗口在另一个屏幕
- 透明度问题

**解决**：
1. 检查所有显示器
2. 或按 ESC 退出，重新运行

---

### 问题 3：控制台有输出，但看不到窗口

**诊断**：
```bash
# 运行测试脚本
python test_gui.py
```

如果能看到测试窗口，说明 PyQt5 正常。
那么主程序也应该能正常显示，只是可能：
- 窗口颜色太深看不见
- 在另一个屏幕

---

### 问题 4：程序无任何反应

**可能原因**：
1. Python 脚本没有执行
2. 依赖缺失但没报错

**诊断**：
```bash
# 检查 Python
python --version

# 检查依赖
python -c "import PyQt5; import mss; import PIL; print('所有依赖正常')"

# 测试 GUI
python test_gui.py
```

---

## 🎯 强制显示方案

如果还是不行，使用这个强制显示版本：

### 创建一个测试文件

创建 `force_test.py`：
```python
import sys
from PyQt5.QtWidgets import QApplication, QWidget
from PyQt5.QtCore import Qt

app = QApplication(sys.argv)

window = QWidget()
window.setWindowTitle("强制显示测试")
window.resize(300, 200)
window.setWindowFlags(Qt.WindowStaysOnTopHint)
window.setStyleSheet("background-color: red;")
window.show()

print("✅ 红色窗口应该已显示")
print("如果看不到，说明 PyQt5 有问题")

sys.exit(app.exec_())
```

运行：
```bash
python force_test.py
```

如果红色窗口都看不到，说明 PyQt5 安装有问题。

---

## 📊 完整诊断流程

```
1. python --version
   ↓
   通过 → 继续
   失败 → 安装 Python

2. python -c "import PyQt5; print('OK')"
   ↓
   通过 → 继续
   失败 → pip install PyQt5

3. python test_gui.py
   ↓
   看到窗口 → PyQt5 正常
   看不到 → PyQt5 问题

4. python screenshot_simple.py
   ↓
   看到黑色窗口 → 正常
   看不到 → 检查显示器/透明度
```

---

## 💡 临时解决方案

如果主程序始终无法显示，可以：

### 使用系统自带截图

**Windows 10/11:**
- Win + Shift + S：区域截图
- Win + PrintScreen：全屏截图

**然后使用预览和编辑工具**

---

## 📞 反馈信息

如果以上都无法解决，请提供：

1. **Python 版本**：`python --version`
2. **依赖检查**：
   ```bash
   python -c "import PyQt5, mss, PIL; print('OK')"
   ```
3. **测试 GUI 结果**：能否看到测试窗口
4. **控制台输出**：运行截图工具的完整输出
5. **Windows 版本**：Win+R → winver

---

## 🔍 调试模式

如果你想看到更多调试信息，可以修改代码：

在 `screenshot_simple.py` 的 `main()` 函数开头添加：
```python
print("调试模式：启用")
print(f"屏幕尺寸: {app.desktop().screenGeometry()}")
print(f"PyQt5 版本: {PyQt5.Qt.PYQT_VERSION_STR}")
```

---

## ✅ 成功标志

程序正常启动时，你会看到：

1. 控制台输出启动信息
2. 屏幕变暗（黑色半透明覆盖）
3. 鼠标变成十字准星
4. 拖动鼠标出现红色矩形框
5. 松开鼠标显示预览窗口

---

## 🎉 快速验证

最简单的方法：

```bash
# 1. 测试 GUI（应该看到窗口）
python test_gui.py

# 2. 如果上面的成功，运行主程序
python screenshot_simple.py

# 3. 屏幕应该变暗
# 4. 按 ESC 退出
```

如果第 1 步都看不到窗口，说明是 PyQt5 的问题，需要重新安装。
